{% extends 'manager/base.html' %} {% block content %}
{% load static %}
<div class="form container">
  <h3>Liste de vos dossiers</h3>
  <h4>Etudiant : {{ first_name }} {{ last_name }} </h4>
  <h5>CIN : {{ user_name }} </h5>

  {% if messages %}
    {% for message in messages %}
    <div class="d-flex justify-content-between alert alert-danger" role="alert">
      {{ message }}
      <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
    {% endfor %}
  {% endif %}

  {% if dossiers %}
  <table class="table table-info table-striped">
    <thead>
      <tr>
        <th scope="col">Type</th>
        <th scope="col">Sujet</th>
        <th scope="col">Encadrant</th>
        <th scope="col">Domaine</th>
        <th scope="col">Operations</th>
      </tr>
    </thead>
    <tbody>
      {% for dossier in dossiers %}
      <tr>
        <td>{{ dossier.get_Type_display }}</td>
        <td>{{ dossier.Sujet }}</td>
        <td>{{ dossier.Encadrant }}</td>
        <td>{{ dossier.Domaine }}</td>
        <td>
          
          <a class="mx-2"  href="{% url 'afficherdossier' dossier.pk %}">
            <img src="{% static 'icons/eye-solid.png' %}" alt="Show" width="18">
          </a>

          <a class="mx-2"  href="{% url 'updatedossier' dossier.pk %}">
            <img src="{% static 'icons/pen-solid.png' %}" alt="Show" width="18">
          </a>

          <a class="mx-2"  href="{% url 'deletedossier' dossier.pk %}" type="button" onclick="confirmDelete()">
            <img src="{% static 'icons/trash-solid.png' %}" alt="Delete" width="18">
          </a>
          
        </td>
      </tr>

      {% endfor %}

      <script>
        function confirmDelete() {
          if (confirm("Êtes-vous sûr de vouloir supprimer cet objet ?")) {
            document.getElementById("deleteForm").submit();
          }
        }
      </script>


    </tbody>
  </table>

  {% else %}
  <h3>Aucun Dossier</h3>
  {% endif %}
 
  <div class="d-grid gap-2">
    <a class="btn btn-primary" href="{% url 'newdossier' niveau nom_filier year user_name %}">Ajouter Nouveau Dossier</a>
  </div> 

  <div class="d-grid gap-2">
    <a class="btn btn-success mt-2" href="{% url 'FiliereEtud' %}">Retour</a>
  </div>
  
</div>

{% endblock content %}
